class RulesEngine{constructor(rules){this.rules=(rules||[]).filter(r=>r.active);}classify(e){for(const r of this.rules)if(this.match(r,e))return{label:r.label,name:r.name,confidence:r.confidence||1,source:'rules'};return null;}match(r,e){const f=(e.from||'').toLowerCase(),s=(e.subject||'').toLowerCase(),b=(e.body||e.snippet||'').toLowerCase();if(r.type==='banka'&&r.senders&&r.senders.length>0&&r.senders.some(x=>f.includes(x.toLowerCase())))return true;const hs=r.senders&&r.senders.length>0,hsk=r.subjectKeys&&r.subjectKeys.length>0,hbk=r.bodyKeys&&r.bodyKeys.length>0;if(!hs&&!hsk&&!hbk)return false;if(hs&&!r.senders.some(x=>f.includes(x.toLowerCase())))return false;if(hsk&&!r.subjectKeys.some(x=>s.includes(x.toLowerCase())))return false;if(hbk&&!r.bodyKeys.some(x=>b.includes(x.toLowerCase())))return false;return true;}}export default RulesEngine;
